\include{commons}
\lecturetitle{Lecture 14: Binomial Coefficients (2)} 

\begin{frame}\frametitle{The binomial coefficients\footnote{This lecture mostly follows Chapter 3 of [LPV].}}
  In this lecture, we shall study the function $\binom{n}{k}$ itself.
  First, let's see the actual value of the binomial coefficients
  $\binom{n}{k}$ for various values of $n$.
  \vspace{2in}
\end{frame}

\begin{frame}\frametitle{What do you see?}
  \begin{itemize}
  \item The function $\binom{n}{\cdot}$ is symmetric around $n/2$.
  \item Why? \pause This is true because we know that $\binom{n}{k}=\binom{n}{n-k}$. \pause
  \item The maximum is at the middle, i.e., when $n$ is even the
    maximum is at $\binom{n}{n/2}$ and when $n$ is odd, the maximum is
    at $\binom{n}{\lfloor n/2 \rfloor}$ and $\binom{n}{\lceil
      n/2\rceil}$.
  \item Why? \pause Can we prove that?
  \end{itemize}
\end{frame}

\begin{frame}\frametitle{Largest in the middle}
  To understand the behavior of $\binom{n}{k}$ as $k$ changes, let's
  look at two consecutive values:
  \[ \binom{n}{k} \ \ \heartsuit \ \ \binom{n}{k+1}\]
  \pause

  Let's write them out:
  \[ \frac{n(n-1)(n-2)\cdots(n-k+1)}{k!} \ \heartsuit \ \frac{n(n-1)(n-2)\cdots(n-k)}{(k+1)k!}.\]
  \pause
  Removing common terms, we can see that we are comparing these two terms:
  \[ 1 \ \heartsuit \ \frac{n-k}{k+1} \Leftrightarrow k \ \heartsuit \ \frac{n-1}{2},\]
  that is, \pause
  \begin{itemize}
  \item if $k<(n-1)/2$, $\binom{n}{k} < \binom{n}{k+1}$; and
  \item if $k>(n-1)/2$, $\binom{n}{k} > \binom{n}{k+1}$.
  \end{itemize}
\end{frame}

\begin{frame}\frametitle{How large is the middle $\binom{n}{n/2}$}
  Here, to simplify the calculation, we shall only consider the case
  when $n$ is even. Let's try to estimate the value of
  $\binom{n}{n/2}$ by finding its upper and lower bounds.
  \pause

  A simple upper bound can be obtain using the fact that
  $\binom{n}{n/2}$ counts subsets of certain size:
  \[\binom{n}{n/2} < 2^n.\]
  \pause

  We can also get a lower bound by noting that the maximum must be at
  least the average, i.e.,
  \[\binom{n}{n/2} \geq \frac{2^n}{n+1}\]
\end{frame}

\begin{frame}
  Combining both bounds, we get that
  \[\frac{2^n}{n+1}\leq \binom{n}{n/2} < 2^n.\]

  \pause Let's plug in $n=200$, and calculate the number of digits to
  see how close these bounds.
  \[27.80 \approx 200\cdot\log 2 - \log 201 \leq \log\binom{n}{n/2} < 200\cdot \log 2\approx 30.10\]
  \pause

  Can we get a better approximation?
\end{frame}

\begin{frame}\frametitle{Concentration}
  \begin{itemize}
  \item We know that the maximum of $\binom{n}{k}$ is obtained when
    $k=n/2$.  From the graph, you can see that, as you move further
    from the middle, the value of the function drops rapidly.
  \item Since we consider even $n$, we let $2m=n$.  One way to
    quantify how fast the values drop is to think about the ratio
    \[ \binom{2m}{m-t}\Big/\binom{2m}{m}. \] \pause
  \item In fact, it is known that
    \[ \binom{2m}{m-t}\Big/\binom{2m}{m} \approx e^{-t^2/m} \]
    \pause
  \item We will use our basic tools to obtain weaker bounds.
  \end{itemize}
\end{frame}

\begin{frame}\frametitle{How close is the approximation?}
  The estimation $e^{-t^2/m}$ is extremely close as shown in the
  figure below, where the gray bars are the actual value of
  $\binom{2m}{m-t}/\binom{2m}{m}$ and the red line is $e^{-t^2/m}$.

  \includegraphics[height=2.2in]{images/binom-approx.png}
\end{frame}

\begin{frame}\frametitle{The actual values}
  Let's try to calculate the ratio
  \begin{eqnarray*}
    \binom{2m}{m-t}\Big/\binom{2m}{m}
    &=&
    \frac{(2m)!}{(m-t)!(2m-m+t)!}\times\frac{m!m!}{(2m)!}\\
    &=&
    \frac{m(m-1)(m-2)\cdots(m-t+1)}{(m+t)(m+t-1)\cdots(m+1)}.
  \end{eqnarray*}
  \pause
  We can use the same logarithm trick.  We have that the log of the
  ratio is
  \[
  \ln\left(\frac{m}{m+t}\right) +
  \ln\left(\frac{m-1}{m+t-1}\right)+\cdots+
  \ln\left(\frac{m-t+1}{m+1}.\right)
  \]
\end{frame}
